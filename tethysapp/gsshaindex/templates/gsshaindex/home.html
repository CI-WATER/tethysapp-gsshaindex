{% extends "gsshaindex/base.html" %}

{% load tethys_gizmos %}

{% block app_navigation_items %}
  <li class="title">App Navigation</li>
  <li class="active"><a href="javascript:void(0);" onclick="TETHYS_APP_BASE.exit_app('{% url 'app_library' %}');">Home</a></li>
  <li><a href="">Load New Models</a></li>
  <li class="separator"></li>
  <li><a href="{% url 'gsshaindex:status'%}">Unsubmitted Models</a></li>
  <li class="separator"></li>
  <li><a href="{% url 'gsshaindex:status'%}">Completed Models</a></li>
  <li class="separator"></li>
  <li><a href="">Get Started</a></li>
{% endblock %}

{% block primary_content %}
  <div class="module">
    <div class="module-content">
      {% if model_list|length < 1 %}
      	<h1 class="heading_title">No GSSHA Models</h1>
      {% else %}
      	<h1 class="heading_title">GSSHA Model: {{ model_list.0.0 }}</h1>
        <h4>Model Description:</h4>
	    <p id="description">{{ model_list.0.2 }}</p>
	  {% endif %}
      {% gizmo editable_google_map google_map %}
    </div>
  </div>
{% endblock %}

{% block secondary_content %}
   <div class="module module-narrow module-shallow">
    <h2 class="module-heading">
      <i class="icon-globe"></i>
      Select a Model
    </h2>
    <div class="module-content">
        {% if model_list|length < 1 %}
            <p>There are no GSSHA models. Please upload some to your datasets or ensure your models are labeled with "Model" as "GSSHA". </p>
        {% else %}
            <p>Below is a list of GSSHA models stored in the datasets. Please select which one you would like to edit.</p>
            <div id="selector-div">
                    {% gizmo select_input select_model %}
            </div>
        {% endif %}
    </div>

  </div>
{% endblock %}

{% block app_actions %}
  <a href="{% url 'gsshaindex:secondpg' name='bob' %}" class="btn btn-default">Next</a>
  <a href="" class="btn btn-default">Back</a>
{% endblock %}

{% block scripts %}
    {% gizmo_dependencies css %}
    {{ block.super }}
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    {% gizmo_dependencies js %}
	<script>
        $("#selector-div").on("change",function(e){
            file_id = e.val;
            console.log("FileID: " + file_id);
            $.ajax({
                url: "info-by-id/"+file_id
            }).done(function(data){
                description = data.description;
                $('#description').text(description);
                name = data.name;
                $('.heading_title').text("GSSHA Model: " + name);
            });
            TETHYS_EDIT_MAP.swapKmlService('/apps/gsshaindex/get-mask-map/'+file_id);
        });

	</script>
{% endblock %}
